<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <title>Office Attendance Tracker</title>
<style>
  body {
    font-family: system-ui, sans-serif;
    background: #f8f9fa;
    color: #333;
    padding: 20px;
    max-width: 600px;
    margin: auto;
  }

  h2 {
    text-align: center;
    margin-bottom: 10px;
  }

  .nav {
    display: flex;
    justify-content: center;
    gap: 10px;
    margin-bottom: 10px;
  }

  button {
    padding: 6px 12px;
    font-size: 14px;
    border-radius: 6px;
    border: none;
    background: #007bff;
    color: white;
    cursor: pointer;
  }

  button:hover {
    background: #0056b3;
  }

  .calendar {
    display: grid;
    grid-template-columns: repeat(5, 1fr);
    gap: 8px;
    margin-top: 10px;
  }

  .day {
    background: white;
    border-radius: 8px;
    box-shadow: 0 2px 4px rgba(0,0,0,0.1);
    padding: 12px 0;
    text-align: center;
    font-size: 16px;
    cursor: pointer;
    transition: transform 0.1s;
  }

  .day:hover {
    transform: scale(1.05);
  }

  .attended  { background-color: #d4edda; }
  .vacation  { background-color: #cce5ff; }
  .holiday   { background-color: #f8d7da; }
  .planned   { background-color: #fff3cd; }

  p {
    margin-top: 20px;
    font-size: 15px;
    line-height: 1.6;
  }

  p span {
    display: inline-block;
    min-width: 30px;
    font-weight: bold;
  }

  #onTrack {
    font-weight: bold;
    padding: 4px 8px;
    border-radius: 6px;
  }

  #onTrack:before {
    content: '';
    margin-right: 6px;
  }

  #onTrack:empty {
    display: none;
  }

  #onTrack:contains("On track") {
    background-color: #d4edda;
    color: #155724;
  }

  #onTrack:contains("Below target") {
    background-color: #fff3cd;
    color: #856404;
  }
</style>

</head>
<body>
  <div class="nav">
    <button id="prevMonth">Previous</button>
    <button id="nextMonth">Next</button>
  </div>
  <h2 id="monthLabel"></h2>
  <div class="calendar" id="calendar"></div>
<p>
  âœ… Attended: <span id="attendedCount"></span><br>
  ğŸ–ï¸ Vacation: <span id="vacationCount"></span><br>
  ğŸ¦ Bank holidays: <span id="holidayCount"></span><br>
  ğŸ“… Planned: <span id="plannedCount"></span><br><br>
  ğŸ“† Available days: <span id="availableDays"></span><br>
  ğŸ¯ Required attendance (60%): <span id="requiredAttendance"></span><br>
  ğŸ“Š Projected attendance: <span id="projectedAttendance"></span><br>
  ğŸ“ˆ Status: <span id="onTrack"></span>
</p>

<script>
  const calendar = document.getElementById('calendar');
  const monthLabel = document.getElementById('monthLabel');
  const attendedCount = document.getElementById('attendedCount');
  const vacationCount = document.getElementById('vacationCount');
  const holidayCount = document.getElementById('holidayCount');
  const plannedCount = document.getElementById('plannedCount');
  const availableDaysEl = document.getElementById('availableDays');
  const requiredAttendanceEl = document.getElementById('requiredAttendance');
  const projectedAttendanceEl = document.getElementById('projectedAttendance');
  const onTrackEl = document.getElementById('onTrack');
  const prevBtn = document.getElementById('prevMonth');
  const nextBtn = document.getElementById('nextMonth');

  let current = new Date();

  const STATES = ["", "attended", "vacation", "holiday", "planned"];
  const LABELS = {
    attended: "âœ…",
    vacation: "ğŸ–ï¸",
    holiday:  "ğŸ¦",
    planned:  "ğŸ“…"
  };

  function renderCalendar(dateObj) {
    calendar.innerHTML = '';
    const year = dateObj.getFullYear();
    const month = dateObj.getMonth();
    const key = `attendance-${year}-${month + 1}`;
    let stateMap = JSON.parse(localStorage.getItem(key)) || {};

    const daysInMonth = new Date(year, month + 1, 0).getDate();

    let counts = { attended: 0, vacation: 0, holiday: 0, planned: 0 };
    let totalWeekdays = 0;

    for (let day = 1; day <= daysInMonth; day++) {
      const date = new Date(year, month, day);
      const dow = date.getDay();
      if (dow === 0 || dow === 6) continue; // skip weekends
      totalWeekdays++;

      const div = document.createElement('div');
      div.className = 'day';
      div.textContent = day;

      let state = stateMap[day] || "";
      if (state) {
        div.classList.add(state);
        div.textContent += " " + LABELS[state];
        counts[state]++;
      }

      div.addEventListener('click', () => {
        let index = STATES.indexOf(state);
        index = (index + 1) % STATES.length;
        state = STATES[index];

        if (state) {
          stateMap[day] = state;
        } else {
          delete stateMap[day];
        }

        localStorage.setItem(key, JSON.stringify(stateMap));
        renderCalendar(current);
      });

      calendar.appendChild(div);
    }

    const available = totalWeekdays - counts.vacation - counts.holiday;
    const required = Math.ceil(available * 0.6);
    const projected = counts.attended + counts.planned;
    const onTrack = projected >= required;

    monthLabel.textContent = `${dateObj.toLocaleString('default', { month: 'long' })} ${year}`;
    attendedCount.textContent = counts.attended;
    vacationCount.textContent = counts.vacation;
    holidayCount.textContent = counts.holiday;
    plannedCount.textContent = counts.planned;
    availableDaysEl.textContent = available;
    requiredAttendanceEl.textContent = required;
    projectedAttendanceEl.textContent = projected;
    onTrackEl.textContent = onTrack ? "âœ… On track" : "âš ï¸ Below target";
  }

  prevBtn.addEventListener('click', () => {
    current.setMonth(current.getMonth() - 1);
    renderCalendar(current);
  });

  nextBtn.addEventListener('click', () => {
    current.setMonth(current.getMonth() + 1);
    renderCalendar(current);
  });

  renderCalendar(current);
</script>

</body>
</html>
